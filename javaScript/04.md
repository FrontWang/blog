# js事件循环

**首先需要了解几个概念:**

当程序启动时, 一个[进程](https://baike.baidu.com/item/%E8%BF%9B%E7%A8%8B)被创建，同时也运行一个线程, 即为[主线程](https://baike.baidu.com/item/%E4%B8%BB%E7%BA%BF%E7%A8%8B/9600138?fr=aladdin)，js的运行机制为[单线程](https://baike.baidu.com/item/%E5%8D%95%E7%BA%BF%E7%A8%8B/6972534?fr=aladdin)

先贴一张流程图:

![js事件循环流程图](http://ovqwwz784.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-09-08%20%E4%B8%8B%E5%8D%883.04.05.png)

**流程如下:**

1. 主线程读取js代码, 形成相应的堆和执行栈, 执行同步任务

2. 当主线程遇到异步任务,，指定给异步进程处理, 同时继续执行同步任务
3. 当异步进程处理完毕后， 将相应的异步任务推入到任务队列首部
4. 主线程任务处理完毕后,，查询任务队列，则取出一个任务队列推入到主线程的执行栈
5. 重复执行第2、3、4步，这就称为事件循环

**其中的异步进程有:**
1. 类似onclick等，由浏览器内核的DOM binding模块处理，事件触发时，回调函数添加到任务队列中；
2. setTimeout等，由浏览器内核的Timer模块处理，时间到达时，回调函数添加到任务队列中；
2. Ajax，由浏览器内核的Network模块处理，网络请求返回后，添加到任务队列中。

讲述js事件循环机制主要是想阐述一下执行栈、执行环境(也叫执行上下文)的概念，帮助我们后面更好的理解当调用一个函数时具体发生了什么,如果想更深入了解执行栈、执行环境(上下文)、作用域、作用域链、变量对象、活动的对象等概念的理解，可以看我的另一篇文章[js中的执行栈、执行环境(上下文)、作用域、作用域链、活动对象、变量对象的概念总结](https://segmentfault.com/a/1190000011082342)，希望能结合自己的理解给大家一点帮助，如有问题，还希望大家多多指正。

**需要注意的是只有同步任务执行完毕后, 才会去任务队列中去读取任务，而不是异步程序返回结果即执行此异步任务**